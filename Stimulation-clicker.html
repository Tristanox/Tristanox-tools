<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surcharge de Stimulation MAXIMALE !</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #282b30; /* Fond gris foncé */
            overflow: hidden;
            position: relative;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="10" fill="magenta" stroke="white" stroke-width="2"/></svg>') 16 16, auto;
            transition: filter 0.1s ease-out, background-color 0.1s ease-out; /* Ajout transition pour le fond */
        }
        #clickCounter {
            position: absolute;
            top: 20px;
            left: 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.8em;
            color: #00ff00;
            text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00;
            z-index: 200;
        }
        #autoStimulationButton {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            font-size: 1em;
            font-family: 'Press Start 2P', cursive;
            background-color: #00BFFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 0 0 10px #00BFFF;
            transition: background-color 0.2s, box-shadow 0.2s;
            z-index: 200;
        }
        #autoStimulationButton.active {
            background-color: #FF4500;
            box-shadow: 0 0 15px #FF4500;
        }
        #stimulationButton {
            padding: 20px 40px;
            font-size: 2em;
            cursor: pointer;
            background-color: #ff00ff;
            color: white;
            border: none;
            border-radius: 10px;
            box-shadow: 0 0 20px #ff00ff;
            transition: transform 0.1s ease-out;
            z-index: 100;
            position: relative;
        }
        #stimulationButton:active {
            transform: scale(0.95);
        }
        .event-text {
            position: absolute;
            font-size: 1.5em;
            color: white;
            opacity: 0;
            animation: fadeOutUp 2s forwards;
            pointer-events: none;
            z-index: 60;
            text-shadow: 0 0 10px white, 0 0 20px magenta;
        }

        /* Nouveau: Texte 3D Pop-up */
        .text-3d-popup {
            position: absolute;
            font-family: 'Press Start 2P', cursive;
            font-size: 3em; /* Plus grand pour l'impact */
            color: #fff;
            text-shadow:
                -3px -3px 0 #00f,
                3px -3px 0 #0f0,
                -3px 3px 0 #f00,
                3px 3px 0 #ff0,
                0 0 15px #fff,
                0 0 30px #0ff;
            opacity: 0;
            transform: translateZ(0); /* Force la 3D */
            animation: popup3D 1.5s forwards;
            pointer-events: none;
            z-index: 120;
        }
        @keyframes popup3D {
            0% { opacity: 0; transform: scale(0.5) translateY(50px) rotateX(90deg); }
            30% { opacity: 1; transform: scale(1.1) translateY(0px) rotateX(0deg); }
            70% { opacity: 1; transform: scale(1) translateY(-10px) rotateX(0deg); }
            100% { opacity: 0; transform: scale(0.8) translateY(-100px) rotateX(-90deg); }
        }

        .event-circle {
            position: absolute;
            border-radius: 50%;
            opacity: 0;
            animation: expandFade 1s forwards;
            pointer-events: none;
            z-index: 60;
            box-shadow: 0 0 15px currentColor;
        }
        .event-image {
            position: absolute;
            max-width: 100px;
            max-height: 100px;
            opacity: 0;
            animation: fadeInOut 2s forwards;
            pointer-events: none;
            z-index: 60;
        }
        .pokemon-image {
            position: absolute;
            width: 150px;
            height: auto;
            opacity: 0;
            animation: fadeInOutPokemon 3s forwards;
            pointer-events: none;
            z-index: 50;
            filter: drop-shadow(0 0 5px blue) drop-shadow(0 0 10px red);
        }
        .pokeball-image {
            position: absolute;
            width: 100px;
            height: auto;
            opacity: 0;
            animation: spinAndFade 3s forwards;
            pointer-events: none;
            z-index: 55;
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.7));
        }
        .bouncing-shape {
            position: absolute;
            background-color: #00ffff;
            box-shadow: 0 0 20px #00ffff;
            pointer-events: none;
            z-index: 70;
        }
        .bouncing-ball {
            border-radius: 50%;
        }
        .bouncing-square {
            border-radius: 0;
        }
        .bouncing-oval {
            border-radius: 50%;
            width: 100px;
            height: 60px;
        }

        .laser-beam {
            position: absolute;
            background: linear-gradient(to right, rgba(255,0,0,0) 0%, rgba(255,0,0,1) 50%, rgba(255,0,0,0) 100%);
            height: 10px;
            width: 100vw;
            opacity: 0;
            animation: sweepLaser 2s forwards;
            pointer-events: none;
            z-index: 90;
        }
        .laser-beam.vertical {
            width: 10px;
            height: 100vh;
            background: linear-gradient(to bottom, rgba(255,0,0,0) 0%, rgba(255,0,0,1) 50%, rgba(255,0,0,0) 100%);
        }
        .particle {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0;
            transform: translate(-50%, -50%);
            animation: explodeParticle 1s forwards;
            pointer-events: none;
            z-index: 80;
        }
        .custom-particle {
            position: absolute;
            background-color: yellow;
            border-radius: 50%;
            opacity: 0;
            animation: customParticleAnim 2s forwards;
            pointer-events: none;
            z-index: 10;
            box-shadow: 0 0 5px currentColor, 0 0 10px currentColor;
        }

        /* Nouveau: Particule géométrique */
        .geometric-particle {
            position: absolute;
            background-color: currentColor;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0) rotate(0deg);
            animation: explodeGeometric 1.5s forwards;
            pointer-events: none;
            z-index: 80;
        }
        /* Styles pour les formes (ajoutés par JS) */
        .geometric-particle.square { border-radius: 0; }
        .geometric-particle.triangle { clip-path: polygon(50% 0%, 0% 100%, 100% 100%); }
        .geometric-particle.diamond { transform: translate(-50%, -50%) scale(0) rotate(45deg); } /* losange */
        @keyframes explodeGeometric {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(0.5) rotate(var(--initial-rot, 0deg)); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(2) translateX(var(--rand-x)) translateY(var(--rand-y)) rotate(var(--final-rot, 720deg)); }
        }

        /* Nouveau: Ligne lumineuse traçante */
        .tracing-line {
            position: absolute;
            background: linear-gradient(to right, transparent, currentColor, transparent);
            height: 3px;
            width: 0;
            opacity: 0;
            animation: traceLine 2s forwards;
            pointer-events: none;
            z-index: 95;
            box-shadow: 0 0 10px currentColor;
        }
        .tracing-line.vertical {
            width: 3px;
            height: 0;
            background: linear-gradient(to bottom, transparent, currentColor, transparent);
            animation: traceLineVertical 2s forwards;
        }
        .tracing-line.diagonal-tlbr { /* top-left to bottom-right */
            width: 5px; height: 5px; /* point de départ */
            background: currentColor;
            animation: traceLineDiagonalTLBR 2s forwards;
            transform-origin: top left;
        }
        .tracing-line.diagonal-trbl { /* top-right to bottom-left */
            width: 5px; height: 5px;
            background: currentColor;
            animation: traceLineDiagonalTRBL 2s forwards;
            transform-origin: top right;
        }

        @keyframes traceLine {
            0% { width: 0; opacity: 0; }
            10% { opacity: 1; width: 50vw; }
            90% { opacity: 1; width: 100vw; }
            100% { opacity: 0; width: 100vw; }
        }
        @keyframes traceLineVertical {
            0% { height: 0; opacity: 0; }
            10% { opacity: 1; height: 50vh; }
            90% { opacity: 1; height: 100vh; }
            100% { opacity: 0; height: 100vh; }
        }
        /* Animations pour les diagonales (implémentées via JS car plus complexe) */

        /* Nouveau: Onde sonore visuelle */
        .sound-wave {
            position: absolute;
            border-radius: 50%;
            border: 5px solid currentColor;
            opacity: 0;
            animation: expandWave 1s forwards;
            pointer-events: none;
            z-index: 60;
            box-shadow: 0 0 20px currentColor;
        }
        @keyframes expandWave {
            0% { transform: scale(0); opacity: 1; border-width: 5px; }
            100% { transform: scale(2); opacity: 0; border-width: 0px; }
        }

        /* Nouveau: Pluie de caractères ASCII */
        .ascii-char {
            position: absolute;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2em;
            color: #00ff00;
            opacity: 0;
            animation: asciiRain 3s forwards;
            pointer-events: none;
            z-index: 40;
            text-shadow: 0 0 5px #00ff00;
        }
        @keyframes asciiRain {
            0% { opacity: 0; transform: translateY(-50px); }
            10% { opacity: 1; }
            100% { opacity: 0; transform: translateY(100vh); }
        }

        /* Nouveau: Effet tunnel */
        .tunnel-effect {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: tunnelZoom 0.5s forwards;
            pointer-events: none;
            z-index: 150;
        }
        @keyframes tunnelZoom {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        /* Nouveau: Mini-icônes "réactions" */
        .reaction-icon {
            position: absolute;
            font-size: 2em; /* Ou taille de l'image */
            opacity: 0;
            animation: floatUpAndFade 2s forwards;
            pointer-events: none;
            z-index: 70;
        }
        @keyframes floatUpAndFade {
            0% { opacity: 0; transform: translateY(0) scale(0.5); }
            20% { opacity: 1; transform: translateY(-20px) scale(1); }
            80% { opacity: 1; transform: translateY(-80px) scale(0.9); }
            100% { opacity: 0; transform: translateY(-100px) scale(0.7); }
        }

        /* Nouveau: Flash monochromatique */
        .monochromatic-flash {
            position: fixed;
            top: 0; left: 0;
            width: 100vw;
            height: 100vh;
            opacity: 0;
            animation: flashScreen 0.2s forwards;
            pointer-events: none;
            z-index: 180;
        }
        @keyframes flashScreen {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Nouveau: Bruit blanc/rose visuel */
        .noise-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100vw;
            height: 100vh;
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAUVBMVEWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFF+oEAAAAGHRSTlMABQoLDxQWGh0eHyAhJCYoKw0gH75jAAAAKElEQVRYw2NgGAWjYBSMgCgYv+B/xYxNhoGjYBhQkQxQ4QxQYQRQ4QxQYARQ4QwAFwQCAZ0gAAAAAElFTkSuQmCC'); /* Petit motif de bruit */
            background-size: 4px 4px; /* Ajuste la taille du grain */
            opacity: 0;
            animation: noiseFade 0.5s forwards;
            pointer-events: none;
            z-index: 160;
        }
        @keyframes noiseFade {
            0% { opacity: 0; }
            50% { opacity: 0.15; } /* Légèrement visible */
            100% { opacity: 0; }
        }

        /* CSS Filters */
        .filter-sepia { filter: sepia(100%); }
        .filter-contrast { filter: contrast(200%); }
        .filter-saturate { filter: saturate(400%); }

        /* Glitch Effect */
        .glitch-active { animation: glitchEffect 0.3s infinite linear; transform-origin: center center; }
        @keyframes glitchEffect {
            0% { transform: skewX(0deg); } 25% { transform: skewX(10deg); filter: hue-rotate(90deg); }
            50% { transform: skewX(-10deg); } 75% { transform: skewX(5deg); filter: hue-rotate(180deg); }
            100% { transform: skewX(0deg); }
        }

        /* Screen Shake Effect */
        .shake-active { animation: screenShake 0.1s infinite; }
        @keyframes screenShake {
            0% { transform: translate(1px, 1px) rotate(0deg); } 25% { transform: translate(-1px, -2px) rotate(-1deg); }
            50% { transform: translate(-3px, 0px) rotate(1deg); } 75% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -1px) rotate(-1deg); }
        }

        /* Fireworks */
        .firework-particle {
            position: absolute;
            background: radial-gradient(white 0%, yellow 30%, orange 60%, transparent 100%);
            border-radius: 50%;
            opacity: 0;
            animation: explodeFirework 1s forwards;
            pointer-events: none;
            z-index: 85;
        }
        @keyframes explodeFirework {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(1.5) translateX(var(--fire-x)) translateY(var(--fire-y)); opacity: 0; }
        }

        /* Neon Shapes */
        .neon-shape {
            position: absolute;
            background-color: transparent;
            border: 2px solid;
            box-shadow: 0 0 5px currentColor, 0 0 15px currentColor, 0 0 30px currentColor;
            opacity: 0;
            animation: neonFade 2s forwards;
            pointer-events: none;
            z-index: 65;
        }
        @keyframes neonFade {
            0% { opacity: 0; transform: scale(0.5); }
            50% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.8); }
        }

        /* Giphy GIF */
        .giphy-gif {
            position: absolute;
            max-width: 200px;
            height: auto;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            opacity: 0;
            animation: fadeInOutGif 4s forwards;
            pointer-events: none;
            z-index: 75;
        }
        @keyframes fadeInOutGif {
            0% { opacity: 0; transform: scale(0.7) rotate(0deg); }
            20% { opacity: 1; transform: scale(1) rotate(5deg); }
            80% { opacity: 1; transform: scale(1) rotate(-5deg); }
            100% { opacity: 0; transform: scale(0.7) rotate(0deg); }
        }

        /* Existing Keyframes */
        @keyframes fadeOutUp { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-50px); } }
        @keyframes expandFade { from { transform: scale(0); opacity: 1; } to { transform: scale(2); opacity: 0; } }
        @keyframes fadeInOut { 0% { opacity: 0; transform: scale(0.5); } 50% { opacity: 1; transform: scale(1); } 100% { opacity: 0; transform: scale(0.5); } }
        @keyframes fadeInOutPokemon { 0% { opacity: 0; transform: scale(0.8) rotate(0deg); } 25% { opacity: 1; transform: scale(1.1) rotate(5deg); } 75% { opacity: 1; transform: scale(1.1) rotate(-5deg); } 100% { opacity: 0; transform: scale(0.8) rotate(0deg); } }
        @keyframes explodeParticle {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(0.5); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(2) translateX(var(--rand-x)) translateY(var(--rand-y)); }
        }
        @keyframes customParticleAnim {
            0% { opacity: 0; transform: scale(0) rotate(0deg); }
            20% { opacity: 1; transform: scale(1) rotate(180deg); }
            80% { opacity: 1; transform: scale(0.8) rotate(360deg); }
            100% { opacity: 0; transform: scale(0.5); }
        }
        @keyframes spinAndFade {
            0% { opacity: 0; transform: scale(0) rotateY(0deg); }
            20% { opacity: 1; transform: scale(1) rotateY(360deg); }
            80% { opacity: 1; transform: scale(1) rotateY(720deg); }
            100% { opacity: 0; transform: scale(0.5) rotateY(1080deg); }
        }
    </style>
</head>
<body>
    <div id="clickCounter">Clics: 0</div>
    <button id="autoStimulationButton">AUTOSTIMULATION</button>
    <button id="stimulationButton">STIMULATION !</button>

    <audio id="clickSound" src="https://www.soundjay.com/buttons/beep-07.mp3" preload="auto"></audio>
    <audio id="laserSound" src="https://www.soundjay.com/misc/sounds/laser-01.mp3" preload="auto"></audio>
    <audio id="pokemonSound" src="https://www.soundjay.com/communication/sounds/bell-ring-01.mp3" preload="auto"></audio>
    <audio id="glitchSound" src="https://www.soundjay.com/misc/sounds/glitch-01.mp3" preload="auto"></audio>
    <audio id="fireworkSound" src="https://www.soundjay.com/buttons/beep-05.mp3" preload="auto"></audio>
    <audio id="pokeballSound" src="https://www.soundjay.com/communication/sounds/ding-01.mp3" preload="auto"></audio>
    <audio id="thumpSound" src="https://www.soundjay.com/buttons/button-10.mp3" preload="auto"></audio>
    <audio id="whooshSound" src="https://www.soundjay.com/misc/sounds/whoosh-1.mp3" preload="auto"></audio>
    <audio id="staticSound" src="https://www.soundjay.com/misc/sounds/static-1.mp3" preload="auto"></audio>


    <script>
        const button = document.getElementById('stimulationButton');
        const clickCounterElement = document.getElementById('clickCounter');
        const autoStimulationButton = document.getElementById('autoStimulationButton');

        const clickSound = document.getElementById('clickSound');
        const laserSound = document.getElementById('laserSound');
        const pokemonSound = document.getElementById('pokemonSound');
        const glitchSound = document.getElementById('glitchSound');
        const fireworkSound = document.getElementById('fireworkSound');
        const pokeballSound = document.getElementById('pokeballSound');
        const thumpSound = document.getElementById('thumpSound'); // Nouveau son
        const whooshSound = document.getElementById('whooshSound'); // Nouveau son
        const staticSound = document.getElementById('staticSound'); // Nouveau son


        let clickCount = 0;
        let autoStimulationInterval = null;

        const GIPHY_API_KEY = '2VM6PXF9Fj9QnHprvewgFGkGwGGy3lBR';

        const eventMessages = [
            "Énergie !", "Boom !", "Flash !", "Pouah !", "Magnifique !",
            "Wow !", "Incroyable !", "Vitesse !", "Impact !", "Explosion !",
            "Pokémon Go !", "Attaque Éclair !", "Super Potion !", "Rebond !",
            "LASER !", "Impulsion !", "Décharge !", "Éclat !", "GLITCH !", "Secousse !",
            "Feux d'artifice !", "Néon !", "GIF !", "Poké Ball !",
            "OVERLOAD !", "SYNERGY !", "MAXIMUM !", "VIBRATIONS !"
        ];

        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#00ffff', '#ff00ff', '#FFA500', '#800080', '#00BFFF', '#FFD700', '#FF1493', '#ADFF2F'];

        const genericImages = [
            'https://upload.wikimedia.org/wikipedia/commons/4/47/PNG_transparency_icon.png',
            'https://cdn-icons-png.flaticon.com/512/36/36601.png',
            'https://www.freeiconspng.com/uploads/lightning-bolt-icon-25.png',
            'https://www.pngall.com/wp-content/uploads/1/Star-PNG-Picture.png',
            'https://www.freeiconspng.com/uploads/confetti-png-21.png'
        ];

        const reactionIcons = [
            '✨', '❤️', '🔥', '🎉', '⚡', '🚀', '🤩', '💯', '🌈', '🎶'
        ];

        const asciiChars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()-_=+[{]}\\|;:'\",<.>/?`~".split('');


        const maxPokemonId = 1025;

        const pokeballImages = [
            "https://archives.bulbagarden.net/media/upload/thumb/2/23/Pok%C3%A9_Ball_Dream_RGB.png/32px-Pok%C3%A9_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/b/b3/Great_Ball_Dream_RGB.png/32px-Great_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/0/01/Ultra_Ball_Dream_RGB.png/32px-Ultra_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/9/91/Master_Ball_Dream_RGB.png/32px-Master_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/b/b1/Premier_Ball_Dream_RGB.png/32px-Premier_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/4/43/Dive_Ball_Dream_RGB.png/32px-Dive_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/e/ef/Luxury_Ball_Dream_RGB.png/32px-Luxury_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/2/2e/Fast_Ball_Dream_RGB.png/32px-Fast_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/1/1d/Love_Ball_Dream_RGB.png/32px-Love_Ball_Dream_RGB.png",
            "https://archives.bulbagarden.net/media/upload/thumb/d/d4/Dream_Ball_Dream_RGB.png/32px-Dream_Ball_Dream_RGB.png"
        ];

        const cssFilters = [
            'filter-sepia',
            'filter-contrast',
            'filter-saturate'
        ];

        const cursorImages = [
            'url("data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="20" fill="lime">✨</text></svg>") 16 16, auto',
            'url("data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="20" fill="yellow">⚡</text></svg>") 16 16, auto',
            'url("data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="20" fill="red">❤️</text></svg>") 16 16, auto'
        ];


        button.addEventListener('click', () => {
            clickCount++;
            clickCounterElement.textContent = `Clics: ${clickCount}`;
            playSound(clickSound);
            createRandomEvent();
            createParticles(button);
            createCustomParticles();

            button.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
            button.style.boxShadow = `0 0 ${20 + clickCount}px ${button.style.backgroundColor}`;
            // Le fond du body ne change plus pour les flashs aléatoires, il reste gris foncé
            // Si on veut des flashs colorés, on peut ajouter un élément temporaire au-dessus du body.
            // document.body.style.backgroundColor = `hsl(${Math.random() * 360}, 50%, 10%)`; // Supprimé
            
            if (clickCount % 10 === 0 || Math.random() < 0.05) {
                applyRandomFilter();
            }

            if (Math.random() < 0.03) {
                triggerGlitch();
            }
        });

        autoStimulationButton.addEventListener('click', () => {
            if (autoStimulationInterval) {
                clearInterval(autoStimulationInterval);
                autoStimulationInterval = null;
                autoStimulationButton.textContent = "AUTOSTIMULATION";
                autoStimulationButton.classList.remove('active');
            } else {
                autoStimulationButton.textContent = "STOP AUTOSTIMULATION";
                autoStimulationButton.classList.add('active');
                autoStimulationInterval = setInterval(() => {
                    button.click();
                }, 250);
            }
        });

        function playSound(audioElement) {
            audioElement.currentTime = 0;
            audioElement.play().catch(e => console.log("Erreur de lecture audio :", e));
        }

        async function createRandomEvent() {
            const eventWeights = [
                { type: 'text', weight: 1 },
                { type: 'circle', weight: 1 },
                { type: 'genericImage', weight: 0.5 },
                { type: 'pokemon', weight: 3 },
                { type: 'bouncingShape', weight: 1.5 },
                { type: 'laser', weight: 0.8 },
                { type: 'fireworks', weight: 1.5 },
                { type: 'neonShape', weight: 1.2 },
                { type: 'randomGif', weight: 4 },
                { type: 'pokeball', weight: 3 },
                { type: 'geometricParticles', weight: 2 }, // Nouveau
                { type: 'text3D', weight: 2 },            // Nouveau
                { type: 'tracingLine', weight: 1.5 },     // Nouveau
                { type: 'soundWave', weight: 1.5 },       // Nouveau
                { type: 'changeCursor', weight: 1 },      // Nouveau
                { type: 'asciiRain', weight: 1 },         // Nouveau
                { type: 'tunnelEffect', weight: 0.7 },    // Nouveau
                { type: 'reactionIcons', weight: 2 },     // Nouveau
                { type: 'monochromaticFlash', weight: 1 },// Nouveau
                { type: 'noiseOverlay', weight: 0.5 }     // Nouveau
            ];

            let totalWeight = 0;
            eventWeights.forEach(event => { totalWeight += event.weight; });

            let randomNum = Math.random() * totalWeight;
            let currentWeight = 0;
            let selectedEventType;

            for (let i = 0; i < eventWeights.length; i++) {
                currentWeight += eventWeights[i].weight;
                if (randomNum < currentWeight) {
                    selectedEventType = eventWeights[i].type;
                    break;
                }
            }

            const x = Math.random() * (window.innerWidth - 150) + 75;
            const y = Math.random() * (window.innerHeight - 150) + 75;

            switch (selectedEventType) {
                case 'text':
                    const textElement = document.createElement('div');
                    textElement.classList.add('event-text');
                    textElement.textContent = eventMessages[Math.floor(Math.random() * eventMessages.length)];
                    textElement.style.left = `${x}px`;
                    textElement.style.top = `${y}px`;
                    document.body.appendChild(textElement);
                    textElement.addEventListener('animationend', () => textElement.remove());
                    break;

                case 'text3D': // Nouveau
                    const text3DElement = document.createElement('div');
                    text3DElement.classList.add('text-3d-popup');
                    text3DElement.textContent = eventMessages[Math.floor(Math.random() * eventMessages.length)];
                    text3DElement.style.left = `${x}px`;
                    text3DElement.style.top = `${y}px`;
                    document.body.appendChild(text3DElement);
                    text3DElement.addEventListener('animationend', () => text3DElement.remove());
                    playSound(whooshSound);
                    break;

                case 'circle':
                    const circleElement = document.createElement('div');
                    circleElement.classList.add('event-circle');
                    const size = Math.random() * 100 + 50;
                    circleElement.style.width = `${size}px`;
                    circleElement.style.height = `${size}px`;
                    circleElement.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    circleElement.style.left = `${x - size / 2}px`;
                    circleElement.style.top = `${y - size / 2}px`;
                    document.body.appendChild(circleElement);
                    circleElement.addEventListener('animationend', () => circleElement.remove());
                    break;

                case 'genericImage':
                    const genericImageElement = document.createElement('img');
                    genericImageElement.classList.add('event-image');
                    genericImageElement.src = genericImages[Math.floor(Math.random() * genericImages.length)];
                    genericImageElement.style.left = `${x - 50}px`;
                    genericImageElement.style.top = `${y - 50}px`;
                    document.body.appendChild(genericImageElement);
                    genericImageElement.addEventListener('animationend', () => genericImageElement.remove());
                    break;

                case 'pokemon':
                    const pokemonId = Math.floor(Math.random() * maxPokemonId) + 1;
                    const paddedId = String(pokemonId).padStart(3, '0');

                    const pokemonImageElement = document.createElement('img');
                    pokemonImageElement.classList.add('pokemon-image');
                    pokemonImageElement.src = `https://www.pokepedia.fr/images/thumb/${String.fromCharCode(97 + Math.floor(Math.random() * 2))}/${String.fromCharCode(97 + Math.floor(Math.random() * 2))}/Miniat_${paddedId}.png/100px-Miniat_${paddedId}.png`;
                    pokemonImageElement.onerror = () => {
                        console.warn(`Impossible de charger l'image Pokémon pour l'ID ${pokemonId} depuis Poképédia. Tentative avec PokeAPI.`);
                        pokemonImageElement.src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${pokemonId}.png`;
                        pokemonImageElement.onerror = () => {
                            console.error("Impossible de charger une image Pokémon, même avec PokeAPI. Utilisation d'une image générique.");
                            pokemonImageElement.src = genericImages[Math.floor(Math.random() * genericImages.length)];
                        };
                    };

                    pokemonImageElement.style.left = `${x - 75}px`;
                    pokemonImageElement.style.top = `${y - 75}px`;
                    document.body.appendChild(pokemonImageElement);
                    pokemonImageElement.addEventListener('animationend', () => pokemonImageElement.remove());
                    playSound(pokemonSound);
                    break;

                case 'bouncingShape':
                    createBouncingShape();
                    shakeScreen();
                    break;

                case 'laser':
                    createLaserBeam();
                    playSound(laserSound);
                    shakeScreen();
                    break;

                case 'fireworks':
                    createFireworks();
                    playSound(fireworkSound);
                    break;

                case 'neonShape':
                    createNeonShape();
                    break;

                case 'randomGif':
                    createRandomGif();
                    break;
                
                case 'pokeball':
                    createPokeball();
                    playSound(pokeballSound);
                    break;

                case 'geometricParticles': // Nouveau
                    createGeometricParticles();
                    break;

                case 'tracingLine': // Nouveau
                    createTracingLine();
                    break;

                case 'soundWave': // Nouveau
                    createSoundWave(event.clientX, event.clientY);
                    playSound(thumpSound);
                    break;
                
                case 'changeCursor': // Nouveau
                    changeCursorTemporarily();
                    break;

                case 'asciiRain': // Nouveau
                    createAsciiRain();
                    break;

                case 'tunnelEffect': // Nouveau
                    createTunnelEffect();
                    break;

                case 'reactionIcons': // Nouveau
                    createReactionIcon();
                    break;

                case 'monochromaticFlash': // Nouveau
                    createMonochromaticFlash();
                    break;

                case 'noiseOverlay': // Nouveau
                    createNoiseOverlay();
                    playSound(staticSound);
                    break;
            }
        }

        function createBouncingShape() {
            const shape = document.createElement('div');
            shape.classList.add('bouncing-shape');
            document.body.appendChild(shape);

            let shapeType = Math.floor(Math.random() * 3); // 0: cercle, 1: carré, 2: ovale
            let sizeX, sizeY;

            switch (shapeType) {
                case 0: // Cercle
                    shape.classList.add('bouncing-ball');
                    sizeX = sizeY = 80;
                    break;
                case 1: // Carré
                    shape.classList.add('bouncing-square');
                    sizeX = sizeY = 80;
                    break;
                case 2: // Ovale
                    shape.classList.add('bouncing-oval');
                    sizeX = 100; // Largeur de l'ovale
                    sizeY = 60;  // Hauteur de l'ovale
                    break;
            }
            shape.style.width = `${sizeX}px`;
            shape.style.height = `${sizeY}px`;

            let posX = Math.random() * (window.innerWidth - sizeX);
            let posY = Math.random() * (window.innerHeight - sizeY);
            let speedX = (Math.random() > 0.5 ? 1 : -1) * (5 + Math.random() * 5);
            let speedY = (Math.random() > 0.5 ? 1 : -1) * (5 + Math.random() * 5);

            shape.style.left = `${posX}px`;
            shape.style.top = `${posY}px`;

            const duration = 5000;
            const startTime = Date.now();

            function animateShape() {
                if (Date.now() - startTime > duration) {
                    shape.remove();
                    return;
                }

                posX += speedX;
                posY += speedY;

                if (posX + sizeX > window.innerWidth || posX < 0) {
                    speedX *= -1;
                    posX = Math.max(0, Math.min(window.innerWidth - sizeX, posX));
                    shape.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                }
                if (posY + sizeY > window.innerHeight || posY < 0) {
                    speedY *= -1;
                    posY = Math.max(0, Math.min(window.innerHeight - sizeY, posY));
                    shape.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                }

                shape.style.left = `${posX}px`;
                shape.style.top = `${posY}px`;

                requestAnimationFrame(animateShape);
            }

            animateShape();
        }

        function createLaserBeam() {
            const laser = document.createElement('div');
            const isVertical = Math.random() > 0.5;
            laser.classList.add('laser-beam');
            if (isVertical) {
                laser.classList.add('vertical');
            }

            if (isVertical) {
                laser.style.left = `${Math.random() * window.innerWidth}px`;
                laser.style.top = `0`;
                laser.style.animation = 'sweepLaserVertical 2s forwards';
            } else {
                laser.style.top = `${Math.random() * window.innerHeight}px`;
                laser.style.left = `0`;
                laser.style.animation = 'sweepLaser 2s forwards';
            }

            document.body.appendChild(laser);
            laser.addEventListener('animationend', () => laser.remove());
        }

        function createParticles(sourceElement) {
            const rect = sourceElement.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const numParticles = 10 + Math.floor(Math.random() * 10);

            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = Math.random() * 10 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                particle.style.left = `${centerX}px`;
                particle.style.top = `${centerY}px`;

                particle.style.setProperty('--rand-x', `${(Math.random() - 0.5) * 400}px`);
                particle.style.setProperty('--rand-y', `${(Math.random() - 0.5) * 400}px`);

                document.body.appendChild(particle);
                particle.addEventListener('animationend', () => particle.remove());
            }
        }

        function createCustomParticles() {
            const numParticles = 30 + Math.floor(Math.random() * 50);
            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('custom-particle');

                const size = Math.random() * 15 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

                particle.style.left = `${Math.random() * window.innerWidth}px`;
                particle.style.top = `${Math.random() * window.innerHeight}px`;

                document.body.appendChild(particle);
                particle.addEventListener('animationend', () => particle.remove());
            }
        }

        // Nouveau: Particules géométriques
        function createGeometricParticles() {
            const numParticles = 15 + Math.floor(Math.random() * 15);
            const centerX = Math.random() * window.innerWidth;
            const centerY = Math.random() * window.innerHeight;

            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('geometric-particle');

                const size = Math.random() * 20 + 10;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${centerX}px`;
                particle.style.top = `${centerY}px`;
                particle.style.color = colors[Math.floor(Math.random() * colors.length)]; // Utilise color pour currentColor

                const shapeType = Math.floor(Math.random() * 3); // 0: square, 1: triangle, 2: diamond
                if (shapeType === 0) particle.classList.add('square');
                else if (shapeType === 1) particle.classList.add('triangle');
                else particle.classList.add('diamond');

                particle.style.setProperty('--rand-x', `${(Math.random() - 0.5) * 500}px`);
                particle.style.setProperty('--rand-y', `${(Math.random() - 0.5) * 500}px`);
                particle.style.setProperty('--initial-rot', `${Math.random() * 360}deg`);
                particle.style.setProperty('--final-rot', `${Math.random() * 1080 + 720}deg`);

                document.body.appendChild(particle);
                particle.addEventListener('animationend', () => particle.remove());
            }
        }

        // Nouveau: Lignes lumineuses traçantes
        function createTracingLine() {
            const line = document.createElement('div');
            line.classList.add('tracing-line');
            line.style.color = colors[Math.floor(Math.random() * colors.length)];

            const direction = Math.floor(Math.random() * 4); // 0: horizontal, 1: vertical, 2: diagonal TL-BR, 3: diagonal TR-BL

            if (direction === 0) { // Horizontal
                line.style.top = `${Math.random() * window.innerHeight}px`;
                line.style.left = `0`;
            } else if (direction === 1) { // Vertical
                line.classList.add('vertical');
                line.style.left = `${Math.random() * window.innerWidth}px`;
                line.style.top = `0`;
            } else if (direction === 2) { // Diagonal TL-BR
                line.classList.add('diagonal-tlbr');
                line.style.left = `${Math.random() * window.innerWidth * 0.7}px`;
                line.style.top = `${Math.random() * window.innerHeight * 0.7}px`;
                line.style.transform = `scale(0) rotate(45deg)`; // Initial scale for animation
                line.style.animation = `traceLineDiagonalTLBR 2s forwards`;
                // Keyframes for diagonal lines (CSS only for now, can be JS for more complex paths)
                const styleSheet = document.styleSheets[0];
                const keyframesName = `traceLineDiagonalTLBR`;
                const rule = `@keyframes ${keyframesName} {
                    0% { transform: scale(0) rotate(45deg); opacity: 0; }
                    10% { transform: scale(1) rotate(45deg); opacity: 1; }
                    90% { opacity: 1; }
                    100% { transform: scale(3) rotate(45deg) translateX(100vw) translateY(100vh); opacity: 0; }
                }`;
                styleSheet.insertRule(rule, styleSheet.cssRules.length);

            } else { // Diagonal TR-BL
                line.classList.add('diagonal-trbl');
                line.style.left = `${Math.random() * window.innerWidth * 0.7 + window.innerWidth * 0.3}px`;
                line.style.top = `${Math.random() * window.innerHeight * 0.7}px`;
                line.style.transform = `scale(0) rotate(-45deg)`; // Initial scale for animation
                line.style.animation = `traceLineDiagonalTRBL 2s forwards`;
                const styleSheet = document.styleSheets[0];
                const keyframesName = `traceLineDiagonalTRBL`;
                const rule = `@keyframes ${keyframesName} {
                    0% { transform: scale(0) rotate(-45deg); opacity: 0; }
                    10% { transform: scale(1) rotate(-45deg); opacity: 1; }
                    90% { opacity: 1; }
                    100% { transform: scale(3) rotate(-45deg) translateX(-100vw) translateY(100vh); opacity: 0; }
                }`;
                styleSheet.insertRule(rule, styleSheet.cssRules.length);
            }

            document.body.appendChild(line);
            line.addEventListener('animationend', () => line.remove());
        }

        // Nouveau: Onde sonore visuelle
        function createSoundWave(clientX, clientY) {
            const wave = document.createElement('div');
            wave.classList.add('sound-wave');
            wave.style.left = `${clientX}px`;
            wave.style.top = `${clientY}px`;
            wave.style.color = colors[Math.floor(Math.random() * colors.length)]; // Utilise color pour currentColor
            document.body.appendChild(wave);
            wave.addEventListener('animationend', () => wave.remove());
        }


        function applyRandomFilter() {
            cssFilters.forEach(filterClass => document.body.classList.remove(filterClass));
            const randomFilter = cssFilters[Math.floor(Math.random() * cssFilters.length)];
            document.body.classList.add(randomFilter);
            setTimeout(() => {
                document.body.classList.remove(randomFilter);
            }, 1000);
        }

        function triggerGlitch() {
            document.body.classList.add('glitch-active');
            playSound(glitchSound);
            setTimeout(() => {
                document.body.classList.remove('glitch-active');
            }, 300);
        }

        function shakeScreen() {
            document.body.classList.add('shake-active');
            setTimeout(() => {
                document.body.classList.remove('shake-active');
            }, 200);
        }

        function createFireworks() {
            const fireworkX = Math.random() * window.innerWidth;
            const fireworkY = Math.random() * window.innerHeight;
            const numFireworkParticles = 30 + Math.floor(Math.random() * 20);

            for (let i = 0; i < numFireworkParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('firework-particle');
                const size = Math.random() * 15 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${fireworkX}px`;
                particle.style.top = `${fireworkY}px`;
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

                particle.style.setProperty('--fire-x', `${(Math.random() - 0.5) * 600}px`);
                particle.style.setProperty('--fire-y', `${(Math.random() - 0.5) * 600}px`);

                document.body.appendChild(particle);
                particle.addEventListener('animationend', () => particle.remove());
            }
        }

        function createNeonShape() {
            const shape = document.createElement('div');
            shape.classList.add('neon-shape');

            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            shape.style.borderColor = randomColor;
            shape.style.boxShadow = `0 0 5px ${randomColor}, 0 0 15px ${randomColor}, 0 0 30px ${randomColor}`;

            const shapeType = Math.floor(Math.random() * 3);
            const size = Math.random() * 100 + 80;

            shape.style.width = `${size}px`;
            shape.style.height = `${size}px`;

            switch (shapeType) {
                case 0: // Circle
                    shape.style.borderRadius = '50%';
                    break;
                case 1: // Square (default)
                    break;
                case 2: // Triangle
                    shape.style.backgroundColor = 'transparent';
                    shape.style.width = '0';
                    shape.style.height = '0';
                    shape.style.borderLeft = `${size / 2}px solid transparent`;
                    shape.style.borderRight = `${size / 2}px solid transparent`;
                    shape.style.borderBottom = `${size}px solid ${randomColor}`;
                    shape.style.boxShadow = 'none';
                    shape.style.filter = `drop-shadow(0 0 5px ${randomColor}) drop-shadow(0 0 15px ${randomColor}) drop-shadow(0 0 30px ${randomColor})`;
                    break;
            }

            const x = Math.random() * (window.innerWidth - size);
            const y = Math.random() * (window.innerHeight - size);
            shape.style.left = `${x}px`;
            shape.style.top = `${y}px`;

            document.body.appendChild(shape);
            shape.addEventListener('animationend', () => shape.remove());
        }

        async function createRandomGif() {
            if (!GIPHY_API_KEY) {
                console.error("La clé API Giphy est manquante. Veuillez la définir.");
                return;
            }

            const gifElement = document.createElement('img');
            gifElement.classList.add('giphy-gif');
            document.body.appendChild(gifElement);

            const x = Math.random() * (window.innerWidth - 200);
            const y = Math.random() * (window.innerHeight - 200);
            gifElement.style.left = `${x}px`;
            gifElement.style.top = `${y}px`;

            try {
                const response = await fetch(`https://api.giphy.com/v1/gifs/random?api_key=${GIPHY_API_KEY}&tag=&rating=g`);
                const data = await response.json();

                if (data && data.data && data.data.images && data.data.images.fixed_height.url) {
                    gifElement.src = data.data.images.fixed_height.url;
                } else {
                    console.warn("Aucun GIF trouvé ou URL invalide depuis Giphy API. Utilisation d'une image générique.");
                    gifElement.src = genericImages[Math.floor(Math.random() * genericImages.length)];
                }
            } catch (error) {
                console.error("Erreur lors de la récupération du GIF depuis Giphy:", error);
                gifElement.src = genericImages[Math.floor(Math.random() * genericImages.length)];
            }

            gifElement.addEventListener('animationend', () => gifElement.remove());
        }

        function createPokeball() {
            const pokeballElement = document.createElement('img');
            pokeballElement.classList.add('pokeball-image');
            pokeballElement.src = pokeballImages[Math.floor(Math.random() * pokeballImages.length)];

            const size = 100;
            const x = Math.random() * (window.innerWidth - size);
            const y = Math.random() * (window.innerHeight - size);
            pokeballElement.style.left = `${x}px`;
            pokeballElement.style.top = `${y}px`;

            document.body.appendChild(pokeballElement);
            pokeballElement.addEventListener('animationend', () => pokeballElement.remove());
        }

        // Nouveau: Changer temporairement le curseur
        let originalCursor = document.body.style.cursor;
        function changeCursorTemporarily() {
            const randomCursor = cursorImages[Math.floor(Math.random() * cursorImages.length)];
            document.body.style.cursor = randomCursor;
            setTimeout(() => {
                document.body.style.cursor = originalCursor;
            }, 1500); // Rétablit le curseur après 1.5s
        }

        // Nouveau: Pluie de caractères ASCII
        function createAsciiRain() {
            const numChars = 10 + Math.floor(Math.random() * 20);
            for (let i = 0; i < numChars; i++) {
                const charElement = document.createElement('div');
                charElement.classList.add('ascii-char');
                charElement.textContent = asciiChars[Math.floor(Math.random() * asciiChars.length)];
                charElement.style.left = `${Math.random() * window.innerWidth}px`;
                charElement.style.top = `-50px`; // Commence au-dessus de l'écran
                charElement.style.color = colors[Math.floor(Math.random() * colors.length)];
                charElement.style.animationDelay = `${Math.random() * 0.5}s`; // Délai pour un effet de pluie
                document.body.appendChild(charElement);
                charElement.addEventListener('animationend', () => charElement.remove());
            }
        }

        // Nouveau: Effet tunnel / vortex
        function createTunnelEffect() {
            const tunnel = document.createElement('div');
            tunnel.classList.add('tunnel-effect');
            document.body.appendChild(tunnel);
            tunnel.addEventListener('animationend', () => tunnel.remove());
        }

        // Nouveau: Apparition de mini-icônes "réactions"
        function createReactionIcon() {
            const iconElement = document.createElement('div');
            iconElement.classList.add('reaction-icon');
            iconElement.textContent = reactionIcons[Math.floor(Math.random() * reactionIcons.length)];
            iconElement.style.left = `${Math.random() * (window.innerWidth - 50) + 25}px`;
            iconElement.style.top = `${window.innerHeight - 50}px`; // Apparaît en bas de l'écran
            document.body.appendChild(iconElement);
            iconElement.addEventListener('animationend', () => iconElement.remove());
        }

        // Nouveau: Flash monochromatique
        function createMonochromaticFlash() {
            const flash = document.createElement('div');
            flash.classList.add('monochromatic-flash');
            flash.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            document.body.appendChild(flash);
            flash.addEventListener('animationend', () => flash.remove());
        }

        // Nouveau: Bruit blanc/rose visuel
        function createNoiseOverlay() {
            const noise = document.createElement('div');
            noise.classList.add('noise-overlay');
            document.body.appendChild(noise);
            noise.addEventListener('animationend', () => noise.remove());
        }

    </script>
</body>
</html>